{{ $headings := findRE "<h2.*?>(.|\n])+?</h2>" .Content }}
{{ $headings_3 := findRE "<h3.*?>(.|\n])+?</h3>" .Content }}
{{ if ge (len $headings) 2 }}
<div id="TableOfContents">
    <ul>
        {{ range $headings }}
        <li>
            {{ $id := findRE "id=\".*\"" . }}
            {{ $id = index $id 0 }}
            {{ $id = strings.TrimPrefix "id=\"" $id }}
            {{ $id = strings.TrimSuffix "\"" $id }}
            <a href="#{{ $id }}">
                {{ . | htmlUnescape | plainify }}
            </a>

            <ul>
                {{ range $headings_3 }}
                <li>
                    {{ $id := findRE "id=\".*\"" . }}
                    {{ $id = index $id 0 }}
                    {{ $id = strings.TrimPrefix "id=\"" $id }}
                    {{ $id = strings.TrimSuffix "\"" $id }}
                    <a href="#{{ $id }}">
                        {{ . | htmlUnescape | plainify }}
                    </a>
                </li>
                {{ end }}
            </ul>

        </li>
        {{ end }}
    </ul>
</div>
{{ end }}